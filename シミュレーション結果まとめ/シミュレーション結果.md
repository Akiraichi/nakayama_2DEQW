# 1. 2次元格子上の量子ウォーク
## 1.1. モデルの説明
### 1.1.1. 確率振幅ベクトル

各場所$(x,y)$に複素成分を持つ4次の縦ベクトル

### 1.1.2. 時間発展ルール
量子ウォークの時間発展は$4\times4$の行列$P,Q,R,S$を用いて、

$\begin{aligned} \vec{\psi}_{t+1}(x, y)=& P \vec{\psi}_{t}(x+1, y)+Q \vec{\psi}_{t}(x-1, y) \\ &+R \vec{\psi}_{t}(x, y+1)+S \vec{\psi}_{t}(x, y-1) \end{aligned}$

で与えられる。ただし4つの行列$P,Q,R,S$は、

$P=\left[\begin{array}{cccc}a_{1} & a_{2} & a_{3} & a_{4} \\ 0 & 0 & 0 & 0 \\ 0 & 0 & 0 & 0 \\ 0 & 0 & 0 & 0\end{array}\right],
Q=\left[\begin{array}{cccc}0 & 0 & 0 & 0 \\ b_{1} & b_{2} & b_{3} & b_{4} \\ 0 & 0 & 0 & 0 \\ 0 & 0 & 0 & 0\end{array}\right]$
$R=\left[\begin{array}{cccc}0 & 0 & 0 & 0 \\ 0 & 0 & 0 & 0 \\ c_{1} & c_{2} & c_{3} & c_{4} \\ 0 & 0 & 0 & 0\end{array}\right],
S=\left[\begin{array}{cccc}0 & 0 & 0 & 0 \\ 0 & 0 & 0 & 0 \\ 0 & 0 & 0 & 0 \\ d_{1} & d_{2} & d_{3} & d_{4}\end{array}\right]$

の形で与えられる。

また、$P+Q+R+S$はユニタリ行列とする

### 1.1.3. 確率

時刻$t$において、場所$x$に量子ウォークの位置が決まる確率は

$\mathbb{P}_{t}(x,y)=\left\|\vec{\psi}_{t}(x,y)\right\|^{2}$

で定義される

## 1.2. モデルに必要な条件
1. $\sum_{x=-\infty}^{\infty}\sum_{y=-\infty}^{\infty}\left\|\vec{\psi}_{0}(x,y)\right\|^{2}=1$が成立するような初期確率振幅ベクトルを設定する
2. $P+Q+R+S$はユニタリ行列である

## 1.3. 注目する行列
次のタイプの行列に注目する

### 1.3.1. グローバーウォーク

$P=\left[\begin{array}{rrrr}-\frac{1}{2} & \frac{1}{2} & \frac{1}{2} & \frac{1}{2} \\ 0 & 0 & 0 & 0 \\ 0 & 0 & 0 & 0 \\ 0 & 0 & 0 & 0\end{array}\right],
Q=\left[\begin{array}{llll}0 & 0 & 0 & 0 \\ \frac{1}{2} & -\frac{1}{2} & \frac{1}{2} & \frac{1}{2} \\ 0 & 0 & 0 & 0 \\ 0 & 0 & 0 & 0\end{array}\right]$
$R=\left[\begin{array}{llll}0 & 0 & 0 & 0 \\ 0 & 0 & 0 & 0 \\ \frac{1}{2} & \frac{1}{2} & -\frac{1}{2} & \frac{1}{2} \\ 0 & 0 & 0 & 0\end{array}\right],
S=\left[\begin{array}{llll}0 & 0 & 0 & 0 \\ 0 & 0 & 0 & 0 \\ 0 & 0 & 0 & 0 \\ \frac{1}{2} & \frac{1}{2} & \frac{1}{2} & -\frac{1}{2}\end{array}\right]$

### 1.3.2. 数学的な結果からわかっている確率分布の性質
グローバーウォーカーが原点$x=0,y=0$から出発するように初期確率振幅ベクトルを設定した時、長時間後の自明でない量子ウォークの確率分布は以下の性質を持つことが知られている

#### 1.3.2.1. 性質1
原点付近に大きな確率をもち得る.
ただし，初期確率振幅べクトルの組合せによっては, この大きな確率は消える.
#### 1.3.2.2. 性質2
原点を中心とする半径 $t/\sqrt{2}$ の円周付近の場所でも，確率分布はピークとなる.
#### 1.3.2.3. 性質3
原点を中心とする半径 $t/\sqrt{2}$ の円の外側に量子ウォーカーの位置が決まる確率は，ほとんど 0 である.

# 2. シミュレーション

## 2.1. 共通の条件

- 行列はグローバーウォーク
- 初期値は$(1,1,-1,-1)$
- 600ステップ目までシミュレーション（初期状態を0ステップ目とする。いくつかは599ステップ目までであるがその場合は明示する。）
- 全てのシミュレーションの結果はシミュレーション結果フォルダに保存している。gif動画も保存しているため、連続的な変化を見たい場合に利用できる。

### 2.1.1. 補足事項
- このレポートで「ピーク」という言葉を使うが、何が「ピーク」であるか正確に定義していない。とりあえず、確率分布が他の場所よりも明らかに大きい場所に対して、「ピークが立っている」と表現している。
- このレポートでは、確率分布の形をプロットした図から目で見て性質を考察しているので、大きい、小さいなど主観的な判断をもとに考察している。客観的に比較・検討すべきではあるが、幅広くシミュレーションして性質を調べている段階では多少主観的な方が都合がいいと考えた。より正確あるいは詳細に調べたいときに、図を目で見て判断するのではなく、プログラムで数字をもとに判断させるとしよう。
- 同様に、今後統計的な解析方法などを適用していく。
- 

## 2.2. x軸方向の一様電場下での2次元グローバーウォーク

$e^{i\theta x}$の形で一様電場下での量子ウォークの振る舞いを調べる。

- 時間発展ルールは以下の通り

$4\times4$のグローバーウォークの$P,Q,R,S$を用いて、

$\begin{aligned} \vec{\psi}_{t+1}(x, y)=e^{i\theta x} (  & P \vec{\psi}_{t}(x+1, y)+Q \vec{\psi}_{t}(x-1, y) \\
&+R \vec{\psi}_{t}(x, y+1)+S \vec{\psi}_{t}(x, y-1) ) \end{aligned}  $

ただし$\theta$は位相、$x$は位置座標である。

### 2.2.1. シミュレーション1
#### 2.2.1.1. 内容
- $\theta = \frac{\pi}{4} n$として、n=1,2,...,60までシミュレーションした
#### 2.2.1.2. プロット結果（599ステップ目をプロット）
n=9までを以下に示す。完全な結果はシミュレーション結果フォルダに保存している。

<img src="シミュレーション1の結果（plot_img_phase_exp_2010）/t=599/000.png" width=40%>
<img src="シミュレーション1の結果（plot_img_phase_exp_2010）/t=599/001.png" width=40% >
<img src="シミュレーション1の結果（plot_img_phase_exp_2010）/t=599/002.png" width=40% >
<img src="シミュレーション1の結果（plot_img_phase_exp_2010）/t=599/003.png" width=40% >
<img src="シミュレーション1の結果（plot_img_phase_exp_2010）/t=599/004.png" width=40% >
<img src="シミュレーション1の結果（plot_img_phase_exp_2010）/t=599/005.png" width=40% >
<img src="シミュレーション1の結果（plot_img_phase_exp_2010）/t=599/006.png" width=40% >
<img src="シミュレーション1の結果（plot_img_phase_exp_2010）/t=599/007.png" width=40% >
<img src="シミュレーション1の結果（plot_img_phase_exp_2010）/t=599/008.png" width=40% >

#### 2.2.1.3. 考察
- $\theta$ と $\theta + 2\pi$ は確立分布が完全に一致
- $\theta$ と$-\theta$は確立分布が完全に一致
- 全ての位相でx軸方向へ局在が起こるわけではない。

よって、x軸方向の一様電場下での2次元グローバーウォークについては、以降のシミュレーションでは$\theta=0$〜$\pi$までをシミュレーションすることにする。


### 2.2.2. シミュレーション2
#### 2.2.2.1. 内容
　さらに$\theta$を細かく刻んでシミュレーションすることで、量子ウォークの確率分布と$\theta$との関連性について調べる。
- $\theta = \frac{\pi}{60} n$として、$n=1,2,...,60$までシミュレーションした

#### 2.2.2.2. プロット結果（599ステップ目をプロット）
数が多いため、シミュレーション結果フォルダに保存

#### 2.2.2.3. 考察
- $\theta$が$\frac{3\pi}{10}$より大きくなると、中央にピークが1本立っている場合がほとんどである。
- （主観的だが）$\theta$が$\frac{3\pi}{10}$以下では $\theta$が小さくなっていくに従って、中央のピークが小さくなり、両端にピークが立っていくと思う。特に$\frac{\pi}{6}$より小さい$\theta$では両端のピークが大きくなっていく様子が見えるように思える。

- 前述までの主観的主張の例外として（前後のプロットと比較して大きく確率分布の形が変化した）特徴的なプロットは
$\theta=\frac{\pi}{5},\frac{\pi}{4},\frac{\pi}{3},\frac{\pi}{2},\frac{3\pi}{5},\frac{3\pi}{4},\frac{5\pi}{6},\pi,$の時だと思う。

<img src="シミュレーション2の結果（plot_img_phase_exp_3010）/t=599/011.png" width=40% >
<img src="シミュレーション2の結果（plot_img_phase_exp_3010）/t=599/014.png" width=40% >
<img src="シミュレーション2の結果（plot_img_phase_exp_3010）/t=599/019.png" width=40% >
<img src="シミュレーション2の結果（plot_img_phase_exp_3010）/t=599/029.png" width=40% >
<img src="シミュレーション2の結果（plot_img_phase_exp_3010）/t=599/035.png" width=40% >
<img src="シミュレーション2の結果（plot_img_phase_exp_3010）/t=599/044.png" width=40% >
<img src="シミュレーション2の結果（plot_img_phase_exp_3010）/t=599/049.png" width=40% >

仮説として以下の内容を考えた。
(1) $\theta$が小さいと両端にピークが立つ。$\theta$が大きいと中央にピークが立つ。ただし、いくつか例外がある

(2) 特徴的な確率分布を示した時の$\theta$の中で、$\frac{\pi}{5},\frac{\pi}{4},\frac{\pi}{3},\frac{\pi}{2},\pi$については$\frac{\pi}{自然数}$となっている。$\frac{\pi}{自然数}$の時は特徴的な確率分布を示す。


### 2.2.3. シミュレーション3
#### 2.2.3.1. 内容
　シミュレーション2で見えた$\theta=\frac{\pi}{6}$付近の振る舞いについて、$\theta$が小さくなっていくに従って、中央のピークが小さくなり、両端にピークが立っていくのかどうかを確認したい。また、さらに小さくしていくと、逆に、両端のピークが小さくなり、中央のピークが大きなるのかどうか（振動しているかどうか）を確認したい。
　加えて、$\frac{\pi}{自然数}$の時は特徴的な確率分布を示すかどうかを検討する
- $\theta = \frac{\pi}{240} n$として、$n=1,2,...,40$までシミュレーションした。（TODO:結果に応じて、$n=240$までシミュレーションする。）


#### 2.2.3.2. プロット結果
シミュレーション中

#### 2.2.3.3. 考察



### 2.2.4. シミュレーション4
#### 2.2.4.1. 内容
$\theta=\frac{\pi}{自然数}$についてシミュレーションし、何かしらの共通性がないか検討する。
- $\theta = \frac{\pi}{n} $として、$n=1,2,...,80$までシミュレーションした（599ステップ目まで）
- また、$\theta = \frac{\pi}{10n} $として、$n=1,2,...,60$までシミュレーションした
- また、$\theta = \frac{\pi}{n} $として、$n=600の約数$としてシミュレーションした（599ステップ目まで）

#### 2.2.4.2. プロット結果
数が多いため、シミュレーション結果フォルダに保存。
（$\frac{pi}{61}$だけ、再プロットし忘れでおかしな図になっている点に注意。他は問題ない。）

#### 2.2.4.3. 考察
- ピークは中央に立つ場合もあれば、両端に立つ場合もあり、両端と中央に立つ場合もある。大きなピークの本数も1本、2本、3本、たくさん（同じくらいの大きさのピークが無数にある）と多彩である。
- 大きなピークの本数が中央に1本だけの場合は、比較的2次元量子ウォークの確率分布の形としてはよく見かけるが、このシミュレーションにおいては2本や3本の場合よりも少ない。プロット結果をもとに確認すると$\frac{\pi}{8},\frac{\pi}{9},\frac{\pi}{11},$の3つだけだと思う（$\frac{\pi}{26}$は中央に複数のピークが見えるため微妙なところだ。）この結果は、シミュレーション2の仮説「$\theta$が小さいと両端にピークが立つ。」を補強する結果だ。
- gif動画で$\theta = \frac{\pi}{10},\frac{\pi}{20},...,\frac{\pi}{600} $まで見てみると、確率分布がy軸方向へ膨らんだ後にしぼみ、そして膨らみ、そしてしぼみ、そして膨らみ続けていく様子が見える。可能性として、以下を考えた。
  ①このような現象がこれまでのシミュレーションにも見えていたが確率が小さく、プロットの性質上見えないだけだった。
  ②$\theta$を小さくしていくと、このように見える。普遍的な現象である。
  ③\theta$を小さくしていくと、このように見えるが、$\theta=\frac{\pi}{自然数}$の時にのみ見える現象である。
  ④ブロッホ振動と関係がある現象である。そして既に先行研究で示されている。

- $\theta$の値が十分に低い（大雑把な目安として$\theta=\frac{\pi}{100}$よりも小さい）場合、中央のピークのみが立つことはなかった。この結果は、シミュレーション2の仮説「$\theta$が小さいと両端にピークが立つ。」を補強する結果だ。
- $\theta$の値が十分に低い（大雑把な目安として$\theta=\frac{\pi}{100}$よりも小さい）場合、ピークの本数は本来は4本あるが、位置が重なり合成されることで2本に見えている場合がある。このことから、他の$\theta$でピークが2本の場合も本来は4本である可能性がある（4本である方が自然で2本の場合が特殊であるということ）

- $n=600の約数$としてシミュレーションしたが、今のところ、何か特筆すべきことを発見できていない。TODO:シミュレーション3と比較することで特筆すべき点が見つかるかもしれない。


## 2.3. x軸方向とy軸方向への一様電場下での2次元グローバーウォーク

$e^{i\theta x}e^{i\theta y}$の形で一様電場下での量子ウォークの振る舞いを調べる。

- 時間発展ルールは以下の通り

$4\times4$のグローバーウォークの$P,Q,R,S$を用いて、

$\begin{aligned} \vec{\psi}_{t+1}(x, y)=e^{i\theta x}e^{i\theta y} (  & P \vec{\psi}_{t}(x+1, y)+Q \vec{\psi}_{t}(x-1, y) \\
&+R \vec{\psi}_{t}(x, y+1)+S \vec{\psi}_{t}(x, y-1) ) \end{aligned}  $

ただし$\theta$は位相、$x,y$はそれぞれx軸の位置座標、y軸の位置座標である。


### 2.3.1. シミュレーション5

#### 2.3.1.1. 内容
シミュレーション2において、x軸方向とy軸方向両方に電場をかけた内容と同じ。
- $\theta = \frac{\pi}{60} n$として、$n=1,2,...,60$までシミュレーションした

#### 2.3.1.2. プロット結果（599ステップ目をプロット）
多くの場合、中央のみにピークが立っている。中央のみにピークが立っている以外の結果は$\theta=\frac{\pi}{4},\frac{\pi}{2},\frac{3\pi}{4},\pi,$で見られた。その時のプロット結果を以下に示す。

<img src="シミュレーション5の結果（plot_img_phase_exp_3030）/t=599/014.png" width=40% >
<img src="シミュレーション5の結果（plot_img_phase_exp_3030）/t=599/029.png" width=40% >
<img src="シミュレーション5の結果（plot_img_phase_exp_3030）/t=599/044.png" width=40% >
<img src="シミュレーション5の結果（plot_img_phase_exp_3030）/t=599/059.png" width=40% >


#### 2.3.1.3. 考察
- $\theta=\frac{\pi}{4},\frac{\pi}{2},\frac{3\pi}{4}$では、斜め方向にグローバーウォークが歪んでいる様子が見える。斜め方向に電場をかけたと考えれば説明できる
- プロット図を目で見て確認する性質上、中央の確率分布のピークよりも小さい確率分布はよく見えない。論文に掲載されているようなプロット方法で可視化すると$\frac{\pi}{60}$で斜め方向の確率分布を確認することができそうだ。
- 量子ウォークの発展過程について、確認する必要がありそうだ。



# 3. シミュレーションの実行状況

## 3.1. シミュレーション中
- シミュレーション3（$i=1$〜$40$）

## 3.2. 実施予定で、計算・時間リソースの割り当て待ちリスト
- シミュレーション3（$i=41$〜場合によっては$240$）
- シミュレーション5の時間発展の可視化（i=1について）
- 確率の大きさの度合いを色で分けて可視化できるような2次元プロットのプログラム作成とシミュレーション5での実施


# 4. 新規実験案
- 異なる位相の確率分布を重ね合わせると、他の位相の確率分布の形と一致するだろうか？（異なる位相の確率分布の重ね合わせに対する考察）
- （一様であってもなくても）電場を与えてある時間ステップで電場をなくす（$e^{i\theta r}$の項を1にする）と、量子ウォークはどう発展してくだろうか？電場のない状態のグローバーウォークの形へ収束していくか、それとも何かしらの変化が残り続けるか？
- 電場のないグローバーウォークの形を傾けてz軸方向に写る影の形と電場を与えた上でのグローバーウォークの形と一致するだろうか？（一致する場合はどういう時だろうか？）
- シミュレーション4でy軸方向への膨らみが見られたが、その膨らみの度合いについて、定量的に評価し、位相との関係性を明らかにできるだろうか？また、この膨らみはゴムのように伸び縮みするだろうか？
- 一様電場ではなく、渦巻き上になるように場所によって異なる電場を与えた場合、どのように量子ウォークは発展するだろうか？
- 広がっていく量子ウォーカーに対して、壁のようなものを配置した場合、量子ウォークの発展にどのような影響があるだろうか？回折するだろうか？
- 壁の形によっては、電子回折のように、干渉によって様々なパターンが確率分布として現れるだろうか？あるいはX線回折のように結晶に対する回折の性質（ラウエ条件やブラッグ条件など）が見られるだろうか？
- 今までx方向の実験を行ってきたが、xとy方向どちらも電場をかけると、それはx方向での結果とy方向での結果の重ね合わせの結果になるだろうか？それとも（論文で指摘されていたようにx方向とy方向へ格子状に配置された位置座標では斜めへ進めないため）異なる結果になるだろうか？その場合2次元格子を軸に対して45度回転させてシミュレーションすると斜めへ進めるから上手くいくだろうか？
- x方向とy方向の電場を1：1ではなく例えば、2：1のように差をつけるとそれはx方向での結果とy方向での結果の重ね合わせの割合を電場の割合にした結果と一致するだろうか？それとも異なる結果になるだろうか？


# 5. シミュレーションプログラム改善したいことリスト
- [ ] シミュレーションのリスタート改善：シミュレーションが途中で中止された場合0ステップ目から再開している。プログラム的には中断されたステップの一つ前から再開できるため、改善の余地があり、それは比較的容易に実行できる。
- [ ] シミュレーションの保存エラーハンドリング改善：現在のリスタート処理は、シミュレーションが完了してから保存するように処理を書いているから、保存されているシミュレーションは問題ないという仮定のもと動作させている。つまり保存途中にエラーが出ることを想定していない。保存途中のエラーは今のところgoogle driveのエラーのみで、データサイズが0になるから発見が容易だが、保存でエラーが出た場合はcontinueさせるかエラーで終了させるように改善したいところだ。google driveのエラーでハンドリングすればいいか。
- [ ] シミュレーション速度改善：numpyでforを使わずに配列を操作できるメソッドがある。それを使えばシミュレーションのプログラムに含まれている前処理のコストをいくらか減らせられるだろう。また核となるアルゴリズムの計算コストも減らせられるかもしない。
- [ ] デバッグの自動化：シミュレーションプログラムが正しい結果を出しているか、直近のプログラム修正で変なバグが入っていないかを自動的に検証するプログラムが欲しい。
- [ ] シミュレーション条件の設定方法改善：expファイルに書いているが、もっといい書き方に直したい。
- [ ] make_gif関数の改善：gifでplotするときにgifの速度を変数として外部に出してくれていると、遅くしたい時に便利かなと思った。
- [ ] 量子ゲートを使った量子ウォークについて：量子ゲートを使って1次元量子ウォークを再現することができるそうだ。その場合、品質保証された高速な量子シミュレータを使って量子ウォークすることができるし、IBMの量子コンピュータを使って量子ウォークすることができる。といっても量子ゲートを使って2次元量子ウォークする方法を思いつかないし、時間もなかなか厳しい。
